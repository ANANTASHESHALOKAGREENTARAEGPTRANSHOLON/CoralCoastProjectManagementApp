"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[239],{4314:(e,t,o)=>{o.r(t),o.d(t,{default:()=>V});var l=o(6252),s=o(9963);const r={class:"card"},a={class:"card-body"},d=(0,l._)("h1",null,"Project Information",-1),i=(0,l._)("hr",null,null,-1),n={class:"row"},c=(0,l._)("div",{class:"col-md-4"},[(0,l._)("h2",null,"Description"),(0,l._)("p",{class:"text-instructions"},' Edit the project information and then click the "Update Project" button at the bottom of the page ')],-1),u={class:"col-md-8",style:{"min-height":"610px"}},p={class:"form-group"},h=(0,l.Uk)("Project Name "),m={key:0,class:"error"},j=(0,l._)("br",null,null,-1),g=(0,l.Uk)("Project Description: "),v={key:0,class:"error"},M={key:1,class:"error"},f=(0,l._)("br",null,null,-1),y=["src"],k=(0,l._)("hr",null,null,-1),_={class:"row"},D=(0,l._)("div",{class:"col-md-4"},[(0,l._)("strong",null,"Project Status"),(0,l._)("p",{class:"text-instructions"}," Please update the project's task to reflect it's current status. Then click on the \"Update Project\" button to save the change. ")],-1),w={key:0,class:"col-md-4"},S={key:1,class:"col-md-4"},E={key:0,class:"alert alert-danger"},P={key:2,class:"col-md-4"},R={key:0,class:"alert alert-info"},b=(0,l._)("hr",null,null,-1),q=(0,l._)("hr",null,null,-1),C={key:0},T={key:1,class:"row submit-row"},I={class:"col-md-12"};var O=o(9490),U=o(4250),$=o(6650),L=o(2587),N=o(3058),B=o(8416);const A=o(9669),x={name:"ProjectInformation",setup:()=>({v$:(0,$.ZP)()}),props:{defaultStakeholderImage:{type:String,default:""},organisationResults:{type:Array,default:()=>[]},projectResults:{type:Array,default:()=>[]},userLevel:{type:Number,default:1}},computed:{...(0,U.Se)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},mixins:[N.Z,B.Z],data(){return{isReadOnly:!1,projectDescriptionModel:this.projectResults[0].fields.project_description,projectEndDateModel:O.DateTime.fromISO(this.projectResults[0].fields.project_end_date),projectNameModel:this.projectResults[0].fields.project_name,projectStartDateModel:O.DateTime.fromISO(this.projectResults[0].fields.project_start_date),projectStatusModel:this.projectResults[0].fields.project_status,statusOptions:["Backlog","Blocked","In Progress","Test/Review"]}},validations:{projectDescriptionModel:{required:L.C1,maxLength:(0,L.BS)(63e4)},projectEndDateModel:{required:L.C1},projectNameModel:{required:L.C1},projectStartDateModel:{required:L.C1}},methods:{closeProject:function(){this.projectStatusModel="Closed",this.updateProject()},updateDates:function(e){this.projectEndDateModel=e.end_date,this.projectStartDateModel=e.start_date},updateProject:function(){if(this.v$.$touch(),this.v$.$invalid)return void this.showValidationErrorModal();const e=new FormData;e.set("project_description",this.projectDescriptionModel),e.set("project_end_date",this.projectEndDateModel),e.set("project_name",this.projectNameModel),e.set("project_start_date",this.projectStartDateModel),e.set("project_status",this.projectStatusModel),this.showLoadingModal("Project"),A.post(`${this.rootUrl}project_information/${this.projectResults[0].pk}/save/`,e).then((e=>{this.closeLoadingModal(),"Closed"===this.projectStatusModel&&window.location.reload(!0)})).catch((e=>{this.showErrorModal(e,this.destination)}))}},mounted(){this.userLevel>=3&&this.statusOptions.push("Closed"),this.isReadOnly="Closed"===this.projectResults[0].fields.project_status}},V=(0,o(3744).Z)(x,[["render",function(e,t,o,O,U,$){const L=(0,l.up)("editor"),N=(0,l.up)("v-select"),B=(0,l.up)("stakeholder-information"),A=(0,l.up)("between-dates");return(0,l.wg)(),(0,l.iD)("div",r,[(0,l._)("div",a,[d,i,(0,l._)("div",n,[(0,l.kq)(" DESCRIPTION "),c,(0,l.kq)(" PROJECT FORM "),(0,l._)("div",u,[(0,l.kq)(" PROJECT NAME "),(0,l._)("div",p,[(0,l._)("label",null,[h,!O.v$.projectNameModel.required&&O.v$.projectNameModel.$dirty?((0,l.wg)(),(0,l.iD)("span",m," Please supply a title.")):(0,l.kq)("v-if",!0)]),(0,l.wy)((0,l._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>U.projectNameModel=e),class:"form-control"},null,512),[[s.vModelText,U.projectNameModel]])]),j,(0,l.kq)(" PROJECT DESCRIPTION "),(0,l._)("label",null,[g,!O.v$.projectDescriptionModel.required&&O.v$.projectDescriptionModel.$dirty?((0,l.wg)(),(0,l.iD)("span",v," Please supply a description.")):(0,l.kq)("v-if",!0),O.v$.projectDescriptionModel.maxLength?(0,l.kq)("v-if",!0):((0,l.wg)(),(0,l.iD)("span",M," Sorry - too many characters."))]),f,(0,l._)("img",{src:`${e.staticUrl}NearBeach/images/placeholder/body_text.svg`,class:"loader-image",alt:"loading image for Tinymce"},null,8,y),(0,l.Wm)(L,{init:{height:500,menubar:!1,plugins:"lists",toolbar:["undo redo | formatselect | alignleft aligncenter alignright alignjustify","bold italic strikethrough underline backcolor | bullist numlist outdent indent | removeformat"]},content_css:!1,skin:!1,disabled:U.isReadOnly,modelValue:U.projectDescriptionModel,"onUpdate:modelValue":t[1]||(t[1]=e=>U.projectDescriptionModel=e)},null,8,["disabled","modelValue"])])]),(0,l.kq)(" PROJECT STATUS "),k,(0,l._)("div",_,[D,U.isReadOnly?(0,l.kq)("v-if",!0):((0,l.wg)(),(0,l.iD)("div",w,[(0,l.Wm)(N,{options:U.statusOptions,modelValue:U.projectStatusModel,"onUpdate:modelValue":t[2]||(t[2]=e=>U.projectStatusModel=e)},null,8,["options","modelValue"])])),U.isReadOnly?(0,l.kq)("v-if",!0):((0,l.wg)(),(0,l.iD)("div",S,["Closed"===U.projectStatusModel?((0,l.wg)(),(0,l.iD)("div",E," Saving the project with this status will close the project. ")):(0,l.kq)("v-if",!0)])),U.isReadOnly?((0,l.wg)(),(0,l.iD)("div",P,["Closed"===U.projectStatusModel?((0,l.wg)(),(0,l.iD)("div",R," Project has been closed. ")):(0,l.kq)("v-if",!0)])):(0,l.kq)("v-if",!0)]),(0,l.kq)(" STAKEHOLDER ORGANISATION "),b,(0,l.Wm)(B,{"organisation-results":o.organisationResults,"default-stakeholder-image":o.defaultStakeholderImage},null,8,["organisation-results","default-stakeholder-image"]),(0,l.kq)(" START DATE & END DATE "),q,(0,l.Wm)(A,{destination:"project",onUpdate_dates:t[3]||(t[3]=e=>$.updateDates(e)),"is-dirty-end":O.v$.projectEndDateModel.$dirty||O.v$.projectStartDateModel.$dirty,"end-date-model":U.projectEndDateModel,"start-date-model":U.projectStartDateModel},null,8,["is-dirty-end","end-date-model","start-date-model"]),(0,l.kq)(" Submit and Close Button "),o.userLevel>=2&&!U.isReadOnly?((0,l.wg)(),(0,l.iD)("hr",C)):(0,l.kq)("v-if",!0),U.isReadOnly?(0,l.kq)("v-if",!0):((0,l.wg)(),(0,l.iD)("div",T,[(0,l._)("div",I,[(0,l.kq)(" Close Project "),o.userLevel>=3?((0,l.wg)(),(0,l.iD)("a",{key:0,href:"javascript:void(0)",class:"btn btn-danger",onClick:t[4]||(t[4]=(...e)=>$.closeProject&&$.closeProject(...e))},"Close Project")):(0,l.kq)("v-if",!0),(0,l.kq)(" Update Project "),o.userLevel>=2?((0,l.wg)(),(0,l.iD)("a",{key:1,href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:t[5]||(t[5]=(...e)=>$.updateProject&&$.updateProject(...e))},"Update Project")):(0,l.kq)("v-if",!0)])]))])])}]])},3058:(e,t,o)=>{o.d(t,{Z:()=>s});var l=o(9909);const s={methods:{showErrorModal:function(e,t,o){new l.u_(document.getElementById("loadingModal")).hide(),document.getElementById("errorModalContent").innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new requirement<hr>${e}`,new l.u_(document.getElementById("errorModal")).show()},showValidationErrorModal:function(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new l.u_(document.getElementById("errorModal")).show()}}}},8416:(e,t,o)=>{o.d(t,{Z:()=>s});var l=o(9909);const s={methods:{closeLoadingModal:function(){var e=new l.u_(document.getElementById("loadingModal"));document.getElementById("loadingModalContent").innerHTML="UPDATED SUCCESSFULLY",setTimeout((()=>{e.hide()}),1e3)},showLoadingModal:function(e){new l.u_(document.getElementById("loadingModal")).show(),document.getElementById("loadingModalContent").innerHTML=`Updating your ${e} details`}}}}}]);