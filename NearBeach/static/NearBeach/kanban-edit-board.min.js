"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[765],{8924:(e,t,o)=>{o.r(t),o.d(t,{default:()=>le});var a=o(6252),i=o(3577);const s={class:"card"},n={class:"card-body"},r=(0,a._)("hr",null,null,-1),l={class:"row"},d=(0,a._)("div",{class:"col-md-4"},[(0,a._)("h2",null,"Columns & Levels"),(0,a._)("p",{class:"text-instructions"}," Drag the cards around to sort out the columns how you want them. ")],-1),c={class:"col-md-4"},p={class:"col-md-4"},m=(0,a._)("hr",null,null,-1),u={class:"row submit-row"},h={class:"col-md-12"};var y=o(9963);const b={key:0,class:"error"},I=(0,a._)("br",null,null,-1),_=["id","data-id","data-title"],w=["id","data-id","data-title"],g=(0,a._)("hr",null,null,-1),f=["id"],v={class:"modal-dialog"},k={class:"modal-content"},L={class:"modal-header"},M={class:"modal-title",id:"exampleModalLabel"},P=["id"],C={class:"modal-body"},D={class:"form-group"},N={class:"modal-footer"},Z=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1),$=["id"],B={class:"modal-dialog"},E={class:"modal-content"},U={class:"modal-header"},T={class:"modal-title"},A=["id"],S={class:"modal-body"},x={class:"row"},R=(0,a._)("label",null,[(0,a._)("strong",null,"Destination for Cards")],-1),q=(0,a._)("br",null,null,-1),O=(0,a._)("div",{class:"alert alert-warning"},[(0,a._)("h4",null,"WARNING"),(0,a._)("p",null,"This process can not be reversed. Deleting a {propertyName} will remove it."),(0,a._)("p",null," All existing cards will be moved to the stated location you have provided. Any cards that have been archived or deleted, will still be associated with the removed card. ")],-1),W={class:"modal-footer"},K=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close",-1),F=["disabled"];var V=o(9669),G=o.n(V),H=o(9909),j=o(6542),z=o(3301),J=o(2021),X=o.n(J),Q=o(6650),Y=o(2587),ee=o(5808),te=o(3058);const oe={name:"KanbanPropertyOrder",setup:()=>({v$:(0,Q.ZP)()}),components:{draggable:X(),Icon:j.JO,NSelect:z.Z},props:{isDirty:{type:Boolean,default:!0},isNewMode:{type:Boolean,default:!0},kanbanBoardId:{type:Number,default:0},propertyList:{type:Array,default:()=>[]},propertyName:{type:String,default:""},source:{type:String,default:""}},data(){return{deleteItemId:"",destinationItemId:"",localPropertyList:this.propertyList,newCardDestinationList:[],newPropertyItem:"",singleItemId:""}},mixins:[te.Z,ee.Z],validations:{localPropertyList:{required:Y.C1}},watch:{propertyList:function(){this.localPropertyList=this.propertyList}},methods:{addItem:function(){""!=this.newPropertyItem&&(this.isNewMode?this.newModeAddItem():this.editModeAddItem(),this.sendPropertyListUp(),document.getElementById(`addItemClose${this.propertyName}`).click())},deleteItem:function(){const e=new FormData;e.set("delete_item_id",this.deleteItemId),e.set("destination_item_id",this.destinationItemId.id);const t=`${this.rootUrl}kanban_${this.propertyName.toLowerCase()}/${this.kanbanBoardId}/delete/`;G().post(t,e).then((e=>{this.localPropertyList=this.localPropertyList.filter((e=>e.id!=this.deleteItemId)),this.$emit("update_property_list",{source:this.source,data:this.localPropertyList}),document.getElementById(`deleteItemClose${this.propertyName}`).click()})).catch((e=>{this.showErrorModal(e,"kanban item delete",this.kanbanBoardId)}))},editItem:function(e){this.newPropertyItem=e.target.dataset.title,this.singleItemId=e.target.dataset.id,this.openModal()},editModeAddItem:async function(){const e=`kanban_${this.propertyName.toLowerCase()}_name`,t=`kanban_${this.propertyName.toLowerCase()}_sort_number`,o=this.singleItemId,a=new FormData;if(a.set(e,this.newPropertyItem),a.set(t,this.getMaxId()+1),""==o)var i=`/kanban_${this.propertyName.toLowerCase()}/${this.kanbanBoardId}/new/`;else i=`/kanban_${this.propertyName.toLowerCase()}/${this.singleItemId}/edit/`;await G().post(i,a).then((t=>{const a=t.data[0];""==o?this.localPropertyList.push({id:a.pk,title:a.fields[e]}):this.localPropertyList.forEach((e=>{e.id==this.singleItemId&&(e.title=this.newPropertyItem)})),this.singleItemId="",this.newPropertyItem=""})).catch((e=>{this.showErrorModal(e,"kanban board",this.kanbanBoardId)}))},getMaxId:function(){const e=this.localPropertyList.map((e=>e.id));return e.sort(((e,t)=>e-t))[e.length-1]},newModeAddItem:function(){""==this.singleItemId?this.localPropertyList.push({id:this.getMaxId()+1,title:this.newPropertyItem}):this.localPropertyList.forEach((e=>{e.id==this.singleItemId&&(e.title=this.newPropertyItem)})),this.singleItemId="",this.newPropertyItem=""},openModal:function(){new H.u_(document.getElementById(`addItem${this.propertyName}`)).show()},removeItem:function(e){this.isNewMode?(this.localPropertyList=this.localPropertyList.filter((t=>t.id!=e)),this.sendPropertyListUp()):(this.deleteItemId=e,this.newCardDestinationList=this.localPropertyList.filter((e=>e.id!=this.deleteItemId)).map((e=>({value:e.id,label:e.title}))),this.destinationItemId=this.newCardDestinationList[0].value,new H.u_(document.getElementById(`deleteItem${this.propertyName}`)).show())},sendPropertyListUp:function(){if(this.$emit("update_property_list",{source:this.source,data:this.localPropertyList}),!this.isNewMode){const e=`/kanban_${this.propertyName.toLowerCase()}/${this.kanbanBoardId}/resort/`,t=new FormData;this.localPropertyList.forEach(((e,o)=>{t.append("item",e.id)})),G().post(e,t).then((e=>{})).catch((e=>{}))}}}};var ae=o(3744);const ie=(0,ae.Z)(oe,[["render",function(e,t,o,s,n,r){const l=(0,a.up)("Icon"),d=(0,a.up)("draggable"),c=(0,a.up)("n-select");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("strong",null,(0,i.toDisplayString)(o.propertyName),1),!s.v$.localPropertyList.required&&o.isDirty?((0,a.wg)(),(0,a.iD)("span",b," Please create at least one "+(0,i.toDisplayString)(o.propertyName)+".",1)):(0,a.kq)("v-if",!0),I,(0,a.kq)(" The column of data where you can sort the properties "),(0,a.Wm)(d,{modelValue:n.localPropertyList,"onUpdate:modelValue":t[2]||(t[2]=e=>n.localPropertyList=e),"item-key":"pk","ghost-class":"ghost",onChange:r.sendPropertyListUp},{item:(0,a.w5)((({element:o})=>[((0,a.wg)(),(0,a.iD)("div",{class:"sortable",key:o.id,id:o.id,"data-id":o.id,"data-title":o.title,onDblclick:t[1]||(t[1]=e=>r.editItem(e))},[((0,a.wg)(),(0,a.iD)("strong",{key:o.id,id:o.id,"data-id":o.id,"data-title":o.title},(0,i.toDisplayString)(o.title),9,w)),n.localPropertyList.length>1?((0,a.wg)(),(0,a.iD)("span",{key:0,onClick:t[0]||(t[0]=t=>r.removeItem(e.item.id))},[(0,a.Wm)(l,{icon:e.icons.xCircle},null,8,["icon"])])):(0,a.kq)("v-if",!0)],40,_))])),_:1},8,["modelValue","onChange"]),(0,a.kq)(" ADD BUTTON "),g,(0,a._)("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...e)=>r.openModal&&r.openModal(...e))}," Add "+(0,i.toDisplayString)(o.propertyName)+" Item ",1),(0,a.kq)(" MODAL FOR ADDING AN EXTRA ROW "),(0,a._)("div",{class:"modal fade",id:`addItem${o.propertyName}`,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[(0,a._)("div",v,[(0,a._)("div",k,[(0,a._)("div",L,[(0,a._)("h5",M,"Add/Edit "+(0,i.toDisplayString)(o.propertyName),1),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:`addItemClose${o.propertyName}`},null,8,P)]),(0,a._)("div",C,[(0,a._)("div",D,[(0,a._)("label",null,(0,i.toDisplayString)(o.propertyName)+" Item Description",1),(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>n.newPropertyItem=e),type:"text",class:"form-control"},null,512),[[y.vModelText,n.newPropertyItem]])])]),(0,a._)("div",N,[Z,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...e)=>r.addItem&&r.addItem(...e))}," Save changes ")])])])],8,f),(0,a.kq)(" MODAL FOR DELETING ITEM "),(0,a._)("div",{class:"modal fade",id:`deleteItem${o.propertyName}`,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[(0,a._)("div",B,[(0,a._)("div",E,[(0,a._)("div",U,[(0,a._)("h5",T,"Delete "+(0,i.toDisplayString)(o.propertyName),1),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:`deleteItemClose${o.propertyName}`},null,8,A)]),(0,a._)("div",S,[(0,a.kq)(" CARD DESTINATIONS "),(0,a._)("div",x,[R,(0,a.Wm)(c,{options:n.newCardDestinationList,value:n.destinationItemId,"onUpdate:value":t[6]||(t[6]=e=>n.destinationItemId=e),style:{"z-index":"9999"},class:"new-card-destination"},null,8,["options","value"])]),q,(0,a.kq)(" WARNING "),O]),(0,a._)("div",W,[K,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[7]||(t[7]=(...e)=>r.deleteItem&&r.deleteItem(...e)),disabled:null==this.destinationItemId}," Delete "+(0,i.toDisplayString)(o.propertyName),9,F)])])])],8,$)])}]]);var se=o(9113);const ne=o(9669),re={name:"KanbanEditBoard",setup:()=>({v$:(0,Q.ZP)()}),components:{KanbanPropertyOrder:ie},props:{columnResults:{type:Array,default:()=>[]},kanbanBoardResults:{type:Array,default:()=>[]},levelResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},staticUrl:{type:String,default:"/"},userLevel:{type:Number,default:0}},mixins:[te.Z,se.Z],data:()=>({columnModel:[],levelModel:[]}),validations:{columnModel:{required:Y.C1},levelModel:{required:Y.C1}},methods:{backToBoard:function(){window.location.href=`${this.rootUrl}kanban_information/${this.kanbanBoardResults[0].pk}/`},closeKanban:function(){ne.post(`${this.rootUrl}kanban_information/${this.kanbanBoardResults[0].pk}/close_board/`).then((e=>{window.location.href=`${this.rootUrl}`})).catch((e=>{this.showErrorModal(e,this.destination)}))},updatePropertyList:function(e){this[e.source]=e.data}},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl}),this.$store.commit({type:"updateUserLevel",userLevel:this.userLevel}),this.columnModel=this.columnResults.map((e=>({id:e.pk,title:e.fields.kanban_column_name}))),this.levelModel=this.levelResults.map((e=>({id:e.pk,title:e.fields.kanban_level_name})))}},le=(0,ae.Z)(re,[["render",function(e,t,o,y,b,I){const _=(0,a.up)("kanban-property-order");return(0,a.wg)(),(0,a.iD)("div",s,[(0,a._)("div",n,[(0,a._)("h1",null,(0,i.toDisplayString)(o.kanbanBoardResults[0].fields.kanban_board_name),1),r,(0,a.kq)(" Properties for the drag and drop coloumns/levels "),(0,a._)("div",l,[d,(0,a._)("div",c,[(0,a.Wm)(_,{"property-name":"Column","property-list":b.columnModel,source:"columnModel","is-dirty":y.v$.columnModel.$dirty,"is-new-mode":!1,"kanban-board-id":o.kanbanBoardResults[0].pk,onUpdate_property_list:t[0]||(t[0]=e=>I.updatePropertyList(e))},null,8,["property-list","is-dirty","kanban-board-id"])]),(0,a._)("div",p,[(0,a.Wm)(_,{"property-name":"Level","property-list":b.levelModel,source:"levelModel","is-dirty":y.v$.columnModel.$dirty,"is-new-mode":!1,"kanban-board-id":o.kanbanBoardResults[0].pk,onUpdate_property_list:t[1]||(t[1]=e=>I.updatePropertyList(e))},null,8,["property-list","is-dirty","kanban-board-id"])])]),(0,a.kq)(" SAVE "),m,(0,a._)("div",u,[(0,a._)("div",h,[(0,a._)("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...e)=>I.closeKanban&&I.closeKanban(...e))}," Close Kanban Board "),(0,a._)("button",{class:"btn btn-primary save-changes",onClick:t[3]||(t[3]=(...e)=>I.backToBoard&&I.backToBoard(...e))}," Back to Kanban Board ")])])])])}]])},3058:(e,t,o)=>{o.d(t,{Z:()=>i});var a=o(9909);const i={methods:{showErrorModal:function(e,t,o){new a.u_(document.getElementById("loadingModal")).hide(),document.getElementById("errorModalContent").innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new requirement<hr>${e}`,new a.u_(document.getElementById("errorModal")).show()},showValidationErrorModal:function(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new a.u_(document.getElementById("errorModal")).show()}}}},5808:(e,t,o)=>{o.d(t,{Z:()=>D});var a=o(459),i=o(5555),s=o(9980),n=o(6443),r=o(1327),l=o(3408),d=o(647),c=o(1278),p=o(9672),m=o(5984),u=o(763),h=o(5004),y=o(1321),b=o(5189),I=o(947),_=o(780),w=o(295),g=o(8093),f=o(3843),v=o(2393),k=o(114),L=o(9714),M=o(1323),P=o(2610),C=o(4187);const D={data:()=>({icons:{arrowUp:a.Z,bugIcon:i.Z,bxBriefcase:s.Z,cardChecklist:n.Z,clipboardIcon:r.Z,documentPdf:l.Z,documentText:d.Z,folderIcon:c.Z,groupPresentation:p.Z,imageIcon:m.Z,infoCircle:u.Z,linkIcon:h.Z,linkIcon2:y.Z,linkOut:b.Z,mailIcon:I.Z,microsoftExcel:_.Z,microsoftPowerpoint:w.Z,microsoftWord:g.Z,noteAdd:f.Z,objectStorage:v.Z,passwordIcon:k.Z,trashCan:L.Z,userIcon:M.Z,usersIcon:P.Z,xCircle:C.Z}})}},9113:(e,t,o)=>{o.d(t,{Z:()=>a});const a={methods:{searchTrigger:function(e){""!=e.searchTimeout&&clearTimeout(e.searchTimeout),void 0===e.search?this.searchUndefined(e):this.searchDefined(e)},searchDefined:function(e){e.search.length>=3&&(e.searchTimeout=setTimeout(e.return_function,500,e.search,e.loading))},searchUndefined:function(e){e.searchTimeout=setTimeout(e.return_function,500)}}}}}]);