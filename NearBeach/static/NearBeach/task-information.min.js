"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[462],{7576:(t,e,s)=>{s.r(e),s.d(e,{default:()=>H});var a=s(6252),o=s(9963);const l={class:"card"},i={class:"card-body"},d=(0,a._)("h1",null,"Task Information",-1),n=(0,a._)("hr",null,null,-1),r={class:"row"},u=(0,a._)("div",{class:"col-md-4"},[(0,a._)("h2",null,"Description"),(0,a._)("p",{class:"text-instructions"}," To create a new task, fill out the form and submit at the bottom of the page. ")],-1),k={class:"col-md-8",style:{"min-height":"610px"}},c={class:"form-group"},h=(0,a.Uk)("Task Short Description: "),p={key:0,class:"error"},m=(0,a._)("br",null,null,-1),g=(0,a.Uk)("Task Long Description: "),M={key:0,class:"error"},f={key:1,class:"error"},v=(0,a._)("br",null,null,-1),y=["src"],D=(0,a._)("hr",null,null,-1),S={class:"row"},_=(0,a._)("div",{class:"col-md-4"},[(0,a._)("strong",null,"Task Status"),(0,a._)("p",{class:"text-instructions"}," Please update the task's status to reflect it's current status. Then click on the \"Update Task\" button to save the change. ")],-1),T={key:0,class:"col-md-4"},w={key:1,class:"col-md-4"},E={key:0,class:"alert alert-danger"},q={key:2,class:"col-md-4"},b={key:0,class:"alert alert-info"},R=(0,a._)("hr",null,null,-1),C=(0,a._)("hr",null,null,-1),I={key:0},U={key:1,class:"row submit-row"},$={class:"col-md-12"};var L=s(6650),O=s(2587),A=s(9490),B=s(4250),x=s(3058),P=s(8416);const V=s(9669),N={name:"TaskInformation",setup:()=>({v$:(0,L.ZP)()}),props:{defaultStakeholderImage:{type:String,default:"/"},groupResults:{type:Array,default:()=>[]},stakeholderModel:{type:Array,default:()=>[]},taskResults:{type:Array,default:()=>[]},organisationResults:{type:Array,default:()=>[]},userLevel:{type:Number,default:1}},computed:{...(0,B.Se)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},data(){return{isReadOnly:!1,statusOptions:["Backlog","Blocked","In Progress","Test/Review"],taskDescriptionModel:this.taskResults[0].fields.task_long_description,taskEndDateModel:A.DateTime.fromISO(this.taskResults[0].fields.task_end_date),taskShortDescriptionModel:this.taskResults[0].fields.task_short_description,taskStartDateModel:A.DateTime.fromISO(this.taskResults[0].fields.task_start_date),taskStatusModel:this.taskResults[0].fields.task_status}},mixins:[x.Z,P.Z],validations:{taskDescriptionModel:{required:O.C1,maxLength:(0,O.BS)(63e4)},taskEndDateModel:{required:O.C1},taskShortDescriptionModel:{required:O.C1},taskStartDateModel:{required:O.C1}},methods:{closeTask:function(){this.taskStatusModel="Closed",this.updateTask()},updateTask:function(){if(this.v$.$touch(),this.v$.$invalid)return void this.showValidationErrorModal();this.showLoadingModal("task");const t=new FormData;t.set("task_long_description",this.taskDescriptionModel),t.set("task_end_date",this.taskEndDateModel),t.set("task_short_description",this.taskShortDescriptionModel),t.set("task_start_date",this.taskStartDateModel),t.set("task_status",this.taskStatusModel),V.post(`${this.rootUrl}task_information/${this.taskResults[0].pk}/save/`,t).then((t=>{this.closeLoadingModal(),"Closed"===this.taskStatusModel&&window.location.reload("Closed"===this.taskStatusModel)})).catch((t=>{this.showErrorModal(t,this.destination)}))},updateDates:function(t){this.taskEndDateModel=t.end_date,this.taskStartDateModel=t.start_date},updateGroupModel:function(t){this.groupModel=t},updateStakeholderModel:function(t){this.stakeholderModel=t}},mounted(){this.userLevel>=3&&this.statusOptions.push("Closed"),this.isReadOnly="Closed"===this.taskResults[0].fields.task_status}},H=(0,s(3744).Z)(N,[["render",function(t,e,s,L,O,A){const B=(0,a.up)("editor"),x=(0,a.up)("v-select"),P=(0,a.up)("stakeholder-information"),V=(0,a.up)("between-dates");return(0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("div",i,[d,n,(0,a._)("div",r,[(0,a.kq)(" DESCRIPTION "),u,(0,a.kq)(" Task FORM "),(0,a._)("div",k,[(0,a.kq)(" TASK NAME "),(0,a._)("div",c,[(0,a._)("label",null,[h,!L.v$.taskShortDescriptionModel.required&&L.v$.taskShortDescriptionModel.$dirty?((0,a.wg)(),(0,a.iD)("span",p," Please supply a title.")):(0,a.kq)("v-if",!0)]),(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>O.taskShortDescriptionModel=t),class:"form-control"},null,512),[[o.vModelText,O.taskShortDescriptionModel]])]),m,(0,a.kq)(" TASK DESCRIPTION "),(0,a._)("label",null,[g,!L.v$.taskDescriptionModel.required&&L.v$.taskDescriptionModel.$dirty?((0,a.wg)(),(0,a.iD)("span",M," Please supply a description.")):(0,a.kq)("v-if",!0),L.v$.taskDescriptionModel.maxLength?(0,a.kq)("v-if",!0):((0,a.wg)(),(0,a.iD)("span",f," Sorry - too many characters."))]),v,(0,a._)("img",{src:`${t.staticUrl}NearBeach/images/placeholder/body_text.svg`,class:"loader-image",alt:"loading image for Tinymce"},null,8,y),(0,a.Wm)(B,{init:{height:500,menubar:!1,plugins:"lists",toolbar:["undo redo | formatselect | alignleft aligncenter alignright alignjustify","bold italic strikethrough underline backcolor | bullist numlist outdent indent | removeformat"]},content_css:!1,skin:!1,modelValue:O.taskDescriptionModel,"onUpdate:modelValue":e[1]||(e[1]=t=>O.taskDescriptionModel=t)},null,8,["modelValue"])])]),(0,a.kq)(" TASK STATUS "),D,(0,a._)("div",S,[_,O.isReadOnly?(0,a.kq)("v-if",!0):((0,a.wg)(),(0,a.iD)("div",T,[(0,a.Wm)(x,{options:O.statusOptions,modelValue:O.taskStatusModel,"onUpdate:modelValue":e[2]||(e[2]=t=>O.taskStatusModel=t)},null,8,["options","modelValue"])])),O.isReadOnly?(0,a.kq)("v-if",!0):((0,a.wg)(),(0,a.iD)("div",w,["Closed"===O.taskStatusModel?((0,a.wg)(),(0,a.iD)("div",E," Saving the task with this status will close the task. ")):(0,a.kq)("v-if",!0)])),O.isReadOnly?((0,a.wg)(),(0,a.iD)("div",q,["Closed"===O.taskStatusModel?((0,a.wg)(),(0,a.iD)("div",b," Project has been closed. ")):(0,a.kq)("v-if",!0)])):(0,a.kq)("v-if",!0)]),(0,a.kq)(" STAKEHOLDER ORGANISATION "),R,(0,a.Wm)(P,{"organisation-results":s.organisationResults,"default-stakeholder-image":s.defaultStakeholderImage},null,8,["organisation-results","default-stakeholder-image"]),(0,a.kq)(" START DATE & END DATE "),C,(0,a.Wm)(V,{destination:"task",onUpdate_dates:e[3]||(e[3]=t=>A.updateDates(t)),"is-dirty-end":L.v$.taskEndDateModel.$dirty||L.v$.taskStartDateModel.$dirty,"start-date-model":O.taskStartDateModel,"end-date-model":O.taskEndDateModel},null,8,["is-dirty-end","start-date-model","end-date-model"]),(0,a.kq)(" Submit Button "),s.userLevel>=2&&!O.isReadOnly?((0,a.wg)(),(0,a.iD)("hr",I)):(0,a.kq)("v-if",!0),O.isReadOnly?(0,a.kq)("v-if",!0):((0,a.wg)(),(0,a.iD)("div",U,[(0,a._)("div",$,[(0,a.kq)(" Close Task "),s.userLevel>=3?((0,a.wg)(),(0,a.iD)("a",{key:0,href:"javascript:void(0)",class:"btn btn-danger",onClick:e[4]||(e[4]=(...t)=>A.closeTask&&A.closeTask(...t))},"Close Task")):(0,a.kq)("v-if",!0),(0,a.kq)(" Update Task "),s.userLevel>=2?((0,a.wg)(),(0,a.iD)("a",{key:1,href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:e[5]||(e[5]=(...t)=>A.updateTask&&A.updateTask(...t))},"Update Task")):(0,a.kq)("v-if",!0)])]))])])}]])},3058:(t,e,s)=>{s.d(e,{Z:()=>o});var a=s(9909);const o={methods:{showErrorModal:function(t,e,s){new a.u_(document.getElementById("loadingModal")).hide(),document.getElementById("errorModalContent").innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new requirement<hr>${t}`,new a.u_(document.getElementById("errorModal")).show()},showValidationErrorModal:function(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new a.u_(document.getElementById("errorModal")).show()}}}},8416:(t,e,s)=>{s.d(e,{Z:()=>o});var a=s(9909);const o={methods:{closeLoadingModal:function(){var t=new a.u_(document.getElementById("loadingModal"));document.getElementById("loadingModalContent").innerHTML="UPDATED SUCCESSFULLY",setTimeout((()=>{t.hide()}),1e3)},showLoadingModal:function(t){new a.u_(document.getElementById("loadingModal")).show(),document.getElementById("loadingModalContent").innerHTML=`Updating your ${t} details`}}}}}]);